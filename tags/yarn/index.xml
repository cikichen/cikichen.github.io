<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Yarn on 编程心语</title>
    <link>https://www.ithome.me/tags/yarn/</link>
    <description>Recent content in Yarn on 编程心语</description>
    <generator>Hugo</generator>
    <language>zh-CN</language>
    <copyright>©{year}, All Rights Reserved. Simon Chen</copyright>
    <lastBuildDate>Wed, 12 May 2021 20:34:08 +0800</lastBuildDate>
    <atom:link href="https://www.ithome.me/tags/yarn/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>There is an issue with node-fibers</title>
      <link>https://www.ithome.me/post/2021/05/12/m1%E6%97%A0%E6%B3%95%E7%BC%96%E8%AF%91taro%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</link>
      <pubDate>Wed, 12 May 2021 20:34:08 +0800</pubDate>
      <guid>https://www.ithome.me/post/2021/05/12/m1%E6%97%A0%E6%B3%95%E7%BC%96%E8%AF%91taro%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</guid>
      <description>&lt;h3 id=&#34;macbook-m1和taro&#34;&gt;&lt;code&gt;MacBook M1&lt;/code&gt;和&lt;code&gt;taro&lt;/code&gt;&lt;/h3&gt;&#xA;&lt;p&gt;在MacBook M1上运行&lt;code&gt;taro&lt;/code&gt;项目&lt;code&gt;yarn dev:h5&lt;/code&gt;的时候会报下面的错误：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## There is an issue with `node-fibers` ##&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;`/node_modules/fibers/bin/darwin-arm64-88/fibers.node` is missing.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Try running this to fix the issue: .nvm/versions/node/v15.5.0/bin/node /node_modules/fibers/build&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Error: Cannot find module &amp;#39;node_modules/fibers/bin/darwin-arm64-88/fibers&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;找了很久没找到解决方案，知道找个一个类似的问题：https://www.jianshu.com/p/145015d721a5&lt;/p&gt;&#xA;&lt;h3 id=&#34;解决办法&#34;&gt;解决办法&lt;/h3&gt;&#xA;&lt;p&gt;我的环境如下：&#xA;node： v15.14.0&#xA;taro-cli： v3.2.8&lt;/p&gt;&#xA;&lt;p&gt;先看错误提示:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## There is an issue with `node-fibers` ##&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;`/node_modules/fibers/bin/darwin-arm64-88/fibers.node` is missing.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Try running this to fix the issue: .nvm/versions/node/v15.14.0/bin/node /node_modules/fibers/build&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Error: Cannot find module &amp;#39;node_modules/fibers/bin/darwin-arm64-88/fibers&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;执行&lt;code&gt;/Users/xxx/.nvm/versions/node/v15.14.0/bin/node /Users/xxx/xxx/node_modules/fibers/build&lt;/code&gt;时找不到fibers的&lt;code&gt;darwin-arm64-88&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;在项目目录下执行&lt;code&gt;find . -name fibers.node&lt;/code&gt;，看看输出路径有没有&lt;code&gt;darwin-arm64-88&lt;/code&gt;，如果没有，继续下面步骤2&lt;/li&gt;&#xA;&lt;li&gt;在项目目录手动执行&lt;code&gt;/Users/xxx/.nvm/versions/node/v15.14.0/bin/node /Users/xxx/xxx/node_modules/fibers/build&lt;/code&gt;，输出提示&lt;code&gt;node-gyp not found! Please ensure node-gyp is in your PATH--&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;执行&lt;code&gt;npm install -g node-gyp&lt;/code&gt;安装&lt;code&gt;node-gyp&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;再次执行&lt;code&gt;/Users/xxx/.nvm/versions/node/v15.14.0/bin/node /Users/xxx/xxx/node_modules/fibers/build&lt;/code&gt;，此时报错&lt;code&gt;binding.gyp not found&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;项目目录下执行&lt;code&gt;find . -name binding.gyp&lt;/code&gt;，会发现&lt;code&gt;node_modules/fibers/binding.gyp&lt;/code&gt;，项目中是存在这个文件的&lt;/li&gt;&#xA;&lt;li&gt;项目录下下&lt;code&gt;cd node_modules/fibers&lt;/code&gt;，然后再次执行&lt;code&gt;/Users/xxx/.nvm/versions/node/v15.14.0/bin/node /Users/xxx/xxx/node_modules/fibers/build&lt;/code&gt;，不出意外的话此时应该编译通过了。&lt;/li&gt;&#xA;&lt;li&gt;然后&lt;code&gt;cd ../..&lt;/code&gt;，执行&lt;code&gt;yarn dev:h5&lt;/code&gt;，成功启动。&lt;/li&gt;&#xA;&lt;/ol&gt;</description>
    </item>
    <item>
      <title>Mac上安装yarn和nvm</title>
      <link>https://www.ithome.me/post/2020/10/19/mac%E4%B8%8A%E5%AE%89%E8%A3%85yarn%E5%92%8Cnvm/</link>
      <pubDate>Mon, 19 Oct 2020 17:38:08 +0800</pubDate>
      <guid>https://www.ithome.me/post/2020/10/19/mac%E4%B8%8A%E5%AE%89%E8%A3%85yarn%E5%92%8Cnvm/</guid>
      <description>&lt;p&gt;&lt;code&gt;Mac&lt;/code&gt;上安装&lt;code&gt;yarn&lt;/code&gt;最方便的方式就是命令行输入:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;brew install yarn&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;但是这样会把&lt;code&gt;node&lt;/code&gt;也一并安装，作为开发者来说，保持多个&lt;code&gt;node&lt;/code&gt;版本是必要的，所以我们一般都是通过&lt;code&gt;nvm&lt;/code&gt;来管理&lt;code&gt;node&lt;/code&gt;版本。&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;brew&lt;/code&gt;也提供过&lt;code&gt;brew install yarn --without-node&lt;/code&gt;命令，但是现在已经失效。不必再试。&lt;/p&gt;&#xA;&lt;p&gt;输入&lt;code&gt;brew install&lt;/code&gt;，根据提示我们发现目前可用的指令是&lt;code&gt;brew install yarn --ignore-dependencies&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;运行后会报错，提示你找不到&lt;code&gt;node&lt;/code&gt;，那么我们是不是可以把&lt;code&gt;nvm&lt;/code&gt;的&lt;code&gt;node&lt;/code&gt; link 到&lt;code&gt;brew&lt;/code&gt;去呢？&lt;/p&gt;&#xA;&lt;p&gt;答案是可以的，步骤如下(&lt;code&gt;node&lt;/code&gt;的版本号改为你实际使用的版本):&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;~ which node &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;/usr/local/opt/nvm/versions/node/v14.14.0/bin/node&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;~ mkdir /usr/local/Cellar/node&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;~ ln -s /usr/local/opt/nvm/versions/node/v14.14.0 /usr/local/Cellar/node&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;~ brew link --overwrite node&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;~ brew doctor&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;~ brew install yarn --ignore-dependencies&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;安装这个顺序操作就OK了。&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
